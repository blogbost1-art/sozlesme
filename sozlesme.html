<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Avis Sözleşme - E-imza & PDF</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: Inter, system-ui, -apple-system, Arial, "Helvetica Neue", Helvetica; background:#f8fafc; }
  .modal { max-width:900px; margin:20px auto; padding:20px; background:white; border-radius:8px; box-shadow:0 6px 20px rgba(0,0,0,0.08); }
  #signaturePad { width:100%; height:220px; touch-action: none; background:white; border:1px solid #e5e7eb; border-radius:6px; }
  .btn { background:#b91c1c; color:white; padding:10px 14px; border-radius:6px; font-weight:700; border:none; cursor:pointer; }
  .small-btn { background:#e5e7eb; color:#111827; padding:8px 10px; border-radius:6px; border:none; cursor:pointer; }
  .contract { white-space:pre-wrap; font-size:14px; color:#111827; line-height:1.5; }
  .service-card { border: 1px solid #d1d5db; border-radius: 10px; padding: 16px; background: #f9fafb; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
  .service-card h4 { font-weight: 600; color: #b91c1c; margin-bottom: 6px; }
  .service-card p { font-size: 13px; color: #374151; line-height: 1.4; }
</style>
</head>
<body>
  <div class="modal" id="printArea">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-3">
        <img src="avis.jpg" alt="Avis" style="height:48px;" id="logoImg">
        <h2 class="text-xl font-bold">AVIS Kiralama Sözleşmesi</h2>
      </div>
      <a href="index.html" class="text-sm text-red-600 font-semibold hover:underline">Ana Sayfa</a>
    </div>

    <section class="mb-6">
      <h3 class="font-semibold text-gray-700 mb-4">Hizmetlerimiz</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="service-card">
          <h4>Araç Kiralama - Günlük / Haftalık / Aylık</h4>
          <p>Kısa ve uzun dönem kiralama seçenekleriyle ihtiyacınıza uygun araçları güvenle kiralayabilirsiniz. Filo yönetimi ve teslimat kolaylığı sağlanır.</p>
        </div>
        <div class="service-card">
          <h4>Kasko & Sigorta</h4>
          <p>Tüm araçlarımız tam kapsamlı kasko ve sigorta güvencesi altındadır. Hasar, hırsızlık ve kaza durumlarında müşterilerimizin güvenliği ön plandadır.</p>
        </div>
        <div class="service-card">
          <h4>Yol Yardım & Araç Değişim</h4>
          <p>Herhangi bir arıza veya aksilik durumunda 7/24 yol yardım hizmeti sunulur. Gerektiğinde araç değişim desteği sağlanır.</p>
        </div>
        <div class="service-card">
          <h4>Vale & Teslim Alma</h4>
          <p>Araç teslim ve iade süreçlerinde profesyonel vale ekibimiz hizmet vermektedir. İstediğiniz noktada teslimat kolaylığı sağlanır.</p>
        </div>
      </div>
    </section>

    <section class="mb-6">
      <h3 class="font-semibold text-gray-700 mb-2">Kiralama Sözleşmesi Maddeler</h3>
      <div class="contract p-4 bg-gray-50 rounded" id="contractText">1-) Araçlarda HGS olup (Hızlı Geçiş Sistemi), kiracı kira dönüşü geçiş yaptığı bedel online olarak kontrol edilip araç teslim ettiğinde anlık provizyon ücretinden düşülecektir.
\n... (metin aynı kalır) ...</div>
    </section>

    <section class="mb-4">
      <label class="block mb-2 font-medium">Ad Soyad</label>
      <input id="fullName" class="w-full p-2 border rounded" placeholder="Adınızı ve soyadınızı giriniz">

      <label class="block mt-4 mb-2 font-medium">İmzanız</label>
      <canvas id="signaturePad"></canvas>
      <div class="mt-2 flex gap-2">
        <button class="small-btn" id="clearBtn">İmzayı Temizle</button>
        <button class="btn" id="saveBtn">Onayla ve PDF İndir</button>
      </div>
    </section>
  </div>

<!-- Offline yedek kütüphaneler -->
<script>
window.addEventListener('DOMContentLoaded', ()=>{
  // Eğer CDN yüklenmemişse (offline ortam)
  if (typeof SignaturePad === 'undefined') {
    console.warn('SignaturePad CDN yüklenmedi, yerel sürüm oluşturuluyor...');
    window.SignaturePad = class {
      constructor(canvas, opts){ this.canvas = canvas; this.ctx = canvas.getContext('2d'); this.drawing=false; this.penColor = opts.penColor || '#000'; this._setup(); }
      _setup(){ this.canvas.addEventListener('mousedown', e=>{this.drawing=true;this.ctx.beginPath();this.ctx.moveTo(e.offsetX,e.offsetY);});
        this.canvas.addEventListener('mousemove', e=>{if(this.drawing){this.ctx.strokeStyle=this.penColor;this.ctx.lineWidth=2;this.ctx.lineTo(e.offsetX,e.offsetY);this.ctx.stroke();}});
        window.addEventListener('mouseup', ()=>this.drawing=false);
        this.canvas.addEventListener('touchstart', e=>{e.preventDefault();const t=e.touches[0];const r=this.canvas.getBoundingClientRect();this.drawing=true;this.ctx.beginPath();this.ctx.moveTo(t.clientX-r.left,t.clientY-r.top);});
        this.canvas.addEventListener('touchmove', e=>{e.preventDefault();if(!this.drawing)return;const t=e.touches[0];const r=this.canvas.getBoundingClientRect();this.ctx.lineTo(t.clientX-r.left,t.clientY-r.top);this.ctx.strokeStyle=this.penColor;this.ctx.lineWidth=2;this.ctx.stroke();});
        window.addEventListener('touchend', ()=>this.drawing=false);
      }
      clear(){ this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height); }
      isEmpty(){ const pixels = this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data; return !pixels.some(p=>p!==0); }
      toDataURL(){ return this.canvas.toDataURL('image/png'); }
    }
  }
  if (typeof jspdf === 'undefined' || typeof window.jspdf === 'undefined') {
    window.jspdf = { jsPDF: class { save(){ alert('PDF oluşturma çevrimdışı modda devre dışı'); } } };
  }

  const canvas = document.getElementById('signaturePad');
  const ctx = canvas.getContext('2d');

  function resizeCanvas() {
    const ratio = Math.max(window.devicePixelRatio || 1, 1);
    const width = canvas.clientWidth;
    canvas.width = width * ratio;
    canvas.height = 220 * ratio;
    canvas.style.width = '100%';
    canvas.style.height = '220px';
    ctx.scale(ratio, ratio);
  }
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);

  const signaturePad = new SignaturePad(canvas, { minWidth: 1.2, maxWidth: 2.5, penColor: 'rgb(0,0,0)' });
  document.getElementById('clearBtn').addEventListener('click',()=>signaturePad.clear());

  document.getElementById('saveBtn').addEventListener('click',()=>{
    if (typeof window.jspdf === 'undefined' || !window.jspdf.jsPDF) {
      alert('PDF oluşturma çevrimdışı devre dışı, sadece imza atabilirsiniz.');
      return;
    }
    const name = document.getElementById('fullName').value || 'İsimsiz';
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ unit:'pt', format:'a4' });
    pdf.text('AVIS Kiralama Sözleşmesi', 40, 40);
    if (!signaturePad.isEmpty()) pdf.addImage(signaturePad.toDataURL(), 'PNG', 40, 60, 200, 80);
    pdf.text('Ad Soyad: '+name, 40, 160);
    pdf.save('Avis_Sozlesme_'+name.replace(/\s+/g,'_')+'.pdf');
  });
});
</script>
</body>
</html>