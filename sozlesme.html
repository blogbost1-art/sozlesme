<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AVIS — Araç Kiralama Sözleşme Poliçesi</title>
  <style>
    body{
      background:#f3f3f3;
      margin:0;
      padding:30px 0;
      font-family:Arial,Helvetica,sans-serif;
      display:flex;
      justify-content:center;
    }
    .page{
      width:800px;
      background:#fff;
      padding:60px 60px;
      box-shadow:0 8px 28px rgba(0,0,0,.08);
      position:relative;
      color:#222;
    }
    .brand{
      color:#d1001a;
      font-weight:900;
      font-size:60px;
      text-align:center;
      letter-spacing:3px;
    }
    .subtitle{
      text-align:center;
      font-weight:700;
      color:#2b2b2b;
      margin-top:4px;
      font-size:15px;
    }
    .meta{
      margin-top:18px;
      font-size:12px;
      color:#333;
    }
    .meta .row{
      display:flex;
      justify-content:flex-end;
      font-size:12px;
    }
    .content{
      margin-top:20px;
      font-size:12px;
      line-height:1.44;
      text-align:justify;
    }
    .content p{
      margin:7px 0;
    }
    .note{
      font-size:11px;
      color:#444;
      margin-top:10px;
    }

    .signature-area{
      margin-top:50px;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      padding:0 10px;
    }

    .sig-block{text-align:center;}
    .sig-label{
      font-weight:700;
      font-size:12px;
      margin-bottom:6px;
    }
    .sig-canvas{
      width:260px;
      height:90px;
      border:1px dashed #bbb;
      border-radius:4px;
      background:#fff;
      touch-action:none;
    }

    .stamp-block{
      text-align:center;
      font-size:12px;
      font-weight:700;
      border:1px solid #b00;
      border-radius:6px;
      color:#b00;
      padding:10px;
      margin-top:10px;
      width:220px;
      height:90px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .form-controls{
      margin-top:25px;
      display:flex;
      gap:10px;
      justify-content:center;
    }
    .btn{
      background:#d1001a;
      color:#fff;
      border:none;
      padding:8px 12px;
      border-radius:6px;
      cursor:pointer;
      font-weight:700;
      font-size:12px;
    }

    .no-export{}

    @media print{
      .no-export{display:none}
      .page{box-shadow:none}
      body{background:#fff}
    }
  </style>
</head>
<body>

  <div class="page" id="page">

    <div class="brand">AVIS</div>
    <div class="subtitle">ARAÇ KİRALAMA SÖZLEŞME POLİÇESİ</div>

    <div class="meta">
      <div class="row">
        <strong>Tarih:</strong>&nbsp;<span id="display-date">6 Kasım 2025</span>
      </div>
    </div>

    <div class="content" id="content">

      <p><strong>1-)</strong> Araçlarda HGS olup (Hızlı Geçiş Sistemi), kiracı kira dönüşü geçiş yaptığı bedel online olarak kontrol edilip araç teslim ettiğinde anlık provizyon ücretinden düşülecektir.</p>

      <p><strong>2-)</strong> Kiralanan aracın her ne şekilde ve şartta olursa olsun kiraya verilmesi, bedelsiz de olsa üçüncü şahıslara kullandırılması yasak olup, aracın:
      <br>a) Ek sürücü olarak belirtilmeyen sürücü tarafından aracın kullanılması.
      <br>b) Herhangi bir vasıtayı çekmek veya itmek.
      <br>c) Gelir karşılığı yolcu veya mal taşımasında.
      <br>d) Türkiye Cumhuriyeti sınırları dışında kullanılmasında.</p>

      <p><strong>3-)</strong> Aracın sürücüsü alkol, uyuşturucu, uyku hapları etkisinde olmadığı sürece, aracın zarar görmesi durumunda hasar sorumluluğunu itiraz etmeksizin karşılamayı firmamız olarak kabul ediyoruz.
      <br>a) Poliçe ödemeleri sizin hesaplarınızda kalacaktır. Kasko ve sigorta poliçesi 50.000 TL’dir. 15 dakika sonrasında ödemelerinizi kullanabilirsiniz. İşlemler 15 dakikalık bir süredir.
      <br>b) Kaza anında alkol, uyuşturucu veya uyku geciktirici ilaçlar etkisi altındaysanız; yasal hız sınırlarının aşıldığı durumlarda ve aracın zarar görmesi durumunda masraflar kiracıya aittir.
      <br>c) Sözleşmenin akdinden sonra kiracı herhangi bir nedenle araç kullanma yetkisini kaybederse (ehliyete el konulması durumunda) aracın konumunu atarak vale görevlimize teslim etmesi gerekir.
      <br>d) Araçla alkollü veya uyuşturucu etkisinde kaza yapmanız durumunda araç masrafı ve aracın minimum 120.000 TL pert (değer kaybı) bedeli sizlere aittir.
      <br>e) Kiracı ve kira sözleşmesinde ek sürücü olarak belirlenenlerin haricindeki şahısların aracı kullanması neticesinde meydana gelen hasar ve/veya kazalarda: Aracın çalınması veya zarar görmesi durumunda kasko ve sigorta firmaları araç masraflarını öder. Kazalarda yaralanmalı veya ölümlü durumlarda kasko ve sigorta firmaları sizlere ödeme yapmakla yükümlüdür.</p>

      <p><strong>4-)</strong> Kiracının kiralanan araç ile karıştığı herhangi bir kazada; kiracı alkol, uyuşturucu etkisinde olay yerini terk etmesi durumunda, doğrudan ve dolaylı zararlar kiracıdan talep edilecektir.</p>

      <p class="note"><strong>NOT:</strong> Görüşmelerimiz kayıt altına alınmaktadır. Sözleşmenin WhatsApp üzerinden atılması gereklidir. Sözleşme muhasebe departmanımız tarafından atılacaktır.
      <br><strong>ŞARTLAR UYGUN OLDUĞU TAKDİRDE, WHATSAPP ÜZERİNDEN “OKUDUM, KABUL EDİYORUM” YAZMANIZ GEREKLİDİR.</strong></p>

    </div>

    <div class="signature-area">

      <div>
        <div class="stamp-block">
          AVIS<br>ARAÇ KİRALAMA LTD. ŞTİ.<br>KAŞE
        </div>
      </div>

      <div class="sig-block">
        <div class="sig-label">İmza:</div>
        <canvas id="sigCanvas" class="sig-canvas"></canvas>

        <div class="no-export" style="margin-top:8px;font-size:12px">
          <strong>Ad Soyad:</strong>
          <input id="fullname-input" type="text" placeholder="Ad Soyad" style="padding:6px;border:1px solid #ccc;border-radius:4px;font-size:12px;width:180px">
        </div>
      </div>

    </div>

    <div class="form-controls no-export">
      <button id="clearBtn" class="btn">İmzayı Temizle</button>
      <button id="downloadBtn" class="btn">PDF Olarak İndir</button>
    </div>

  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    const sigCanvas=document.getElementById('sigCanvas');
    const signaturePad=new SignaturePad(sigCanvas,{backgroundColor:'rgba(255,255,255,0)'});

    function fitCanvas(){
      const ratio=Math.max(window.devicePixelRatio||1,1);
      sigCanvas.width=sigCanvas.offsetWidth*ratio;
      sigCanvas.height=sigCanvas.offsetHeight*ratio;
      sigCanvas.getContext('2d').scale(ratio,ratio);
      signaturePad.clear();
    }
    window.addEventListener('resize',fitCanvas);
    fitCanvas();

    document.getElementById('clearBtn').addEventListener('click',()=>signaturePad.clear());

    async function generatePdf(){
      const original=document.getElementById('page');
      const clone=original.cloneNode(true);

      // NO-EXPORT elementlerini kaldır
      clone.querySelectorAll('.no-export').forEach(n=>n.remove());

      const name=document.getElementById('fullname-input').value||'-';
      const dateText=new Date().toLocaleDateString('tr-TR',{day:'numeric',month:'long',year:'numeric'});
      clone.querySelector('#display-date').textContent=dateText;

      // İmza alanını görsele çevir
      const cloneCanvas=clone.querySelector('#sigCanvas');
      if(!signaturePad.isEmpty()){
        const img=document.createElement('img');
        img.src=signaturePad.toDataURL('image/png');
        img.style.width='260px';
        img.style.height='90px';
        cloneCanvas.parentNode.replaceChild(img,cloneCanvas);
      }

      // Watermark
      const wm=document.createElement('div');
      wm.textContent='AVIS';
      wm.style.position='absolute';
      wm.style.top='37%';
      wm.style.left='50%';
      wm.style.transform='translate(-50%,-50%)';
      wm.style.fontSize='220px';
      wm.style.fontWeight='900';
      wm.style.color='rgba(200,0,0,0.07)';
      wm.style.pointerEvents='none';
      clone.appendChild(wm);

      // Gri arka plan
      clone.style.background='#f7f7f7';

      clone.style.position='fixed';
      clone.style.left='-5000px';
      document.body.appendChild(clone);

      const canvas=await html2canvas(clone,{scale:2,backgroundColor:'#fff',useCORS:true});
      const imgData=canvas.toDataURL('image/png');
      document.body.removeChild(clone);

      const {jsPDF}=window.jspdf;
      const pdf=new jsPDF('p','pt','a4');
      const pageWidth=pdf.internal.pageSize.getWidth();
      const pageHeight=pdf.internal.pageSize.getHeight();

      // ✅ TAM SAYFAYA YAY
      pdf.addImage(imgData,'PNG',0,0,pageWidth,pageHeight);

      pdf.save(`Kiralama_Sozlesme_${name.replace(/\s+/g,'_')}.pdf`);
    }

    document.getElementById('downloadBtn').addEventListener('click',generatePdf);
  </script>
</body>
</html>
